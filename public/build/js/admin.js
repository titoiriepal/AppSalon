let fechas=[];function iniciarApp(){conseguirFechasAPI(),iniciarBotonMostrar(),paginacionFechas()}function iniciarBotonMostrar(){document.querySelectorAll(".boton-mostrar").forEach(e=>{e.addEventListener("click",(function(e){idDiv=e.target.dataset.idcita,identificador="#"+idDiv,divMostrar=document.querySelector(identificador),divMostrar.classList.toggle("ocultar")}))})}function paginacionFechas(){const e=document.getElementById("botFechaSiguiente"),t=document.getElementById("botFechaAnterior"),n=document.getElementById("mostrarTipoCitas").value;t.addEventListener("click",()=>{const e=fechas.findIndex(e=>e>=t.dataset.fecha);if(0!=e){const t=fechas[e-1];console.log(e),window.location=`?fecha=${t}&tipoCitas=${n}`}}),e.addEventListener("click",()=>{const t=fechas.findIndex(t=>t>=e.dataset.fecha);if(t!=fechas.length-1){const e=fechas[t+1];console.log(t),window.location=`?fecha=${e}&tipoCitas=${n}`}})}async function conseguirFechasAPI(){try{const e="http://localhost:33000/api/fechas",t=await fetch(e);iniciarFechas(await t.json())}catch(e){console.log(e)}}function iniciarFechas(e){let t=!0;const n=new Set(e.map(e=>e.split("-")[0])),o=document.getElementById("year");o.addEventListener("change",updateMonths()),n.forEach(e=>{o.add(new Option(e,e,t)),t=!1}),fechas=e}function updateMonths(){const e=document.getElementById("year").value,t=new Set(fechas.filter(t=>t.startsWith(e)).map(e=>e.split("-")[1])),n=document.getElementById("mes");n.innerHTML="<option>Selecciona un mes</option>",t.forEach(e=>{n.add(new Option(getMonthName(e),e))}),document.getElementById("dia").innerHTML="<option>Selecciona un día</option>"}function updateDays(){const e=document.getElementById("year").value,t=document.getElementById("mes").value,n=document.getElementById("mostrarTipoCitas").value,o=new Set(fechas.filter(n=>n.startsWith(`${e}-${t}`)).map(e=>e.split("-")[2])),i=document.getElementById("dia");i.innerHTML="<option>Selecciona un día</option>",o.forEach(e=>{i.add(new Option(e,e))}),i.addEventListener("input",(function(){dia=i.value;const o=`${e}-${t}-${dia}`;window.location=`?fecha=${o}&tipoCitas=${n}`}))}function getMonthName(e){const t=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],n=parseInt(e)-1;return n>=0&&n<12?t[n]:"Mes inválido"}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));